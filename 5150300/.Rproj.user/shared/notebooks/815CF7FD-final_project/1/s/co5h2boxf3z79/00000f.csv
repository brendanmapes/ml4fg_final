"0","# Create dataframe for beta cell proportions and HbA1c levels"
"0","m.prop.ana = data.frame(pData(GSE50244.bulk.eset)[rep(1:89, 2), c('age', 'bmi', 'hba1c', 'gender')],"
"0","                        ct.prop = c(Est.prop.GSE50244$Est.prop.weighted[, 2], "
"0","                                    Est.prop.GSE50244$Est.prop.allgene[, 2]), "
"0","                        Method = factor(rep(c('MuSiC', 'NNLS'), each = 89), "
"0","                        levels = c('MuSiC', 'NNLS')))"
"0","colnames(m.prop.ana)[1:4] = c('Age', 'BMI', 'HbA1c', 'Gender')"
"0","m.prop.ana = subset(m.prop.ana, !is.na(HbA1c))"
"0","m.prop.ana$Disease = factor( c('Normal', 'T2D')[(m.prop.ana$HbA1c > 6.5) + 1], c('Normal', 'T2D') )"
"0","m.prop.ana$D = (m.prop.ana$Disease == 'T2D')/5"
"0",""
"0","ggplot(m.prop.ana, aes(HbA1c, ct.prop)) + "
"0","  geom_smooth(method = 'lm',  se = FALSE, col = 'black', lwd = 0.25) +"
"0","  geom_point(aes(fill = Method, color = Disease, stroke = D, shape = Disease), size = 2, alpha = 0.7) +  facet_wrap(~ Method) + "
"0","  ggtitle('HbA1c vs Beta Cell Type Proportion') + theme_minimal() + "
"0","  scale_colour_manual( values = c('white', ""gray20"")) + "
"0","  scale_shape_manual(values = c(21, 24))"
"2","Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
Please use `linewidth` instead."
