"0","library(MuSiC)"
"0","library(dplyr)"
"0","library(reshape2)"
"0","library(cowplot)"
"0","# Jitter plot of estimated cell type proportions"
"0","jitter.fig = Jitter_Est(list(data.matrix(Est.prop.GSE50244$Est.prop.weighted),"
"0","                             data.matrix(Est.prop.GSE50244$Est.prop.allgene)),"
"0","                        method.name = c('MuSiC', 'NNLS'), title = 'Jitter plot of Est Proportions')"
"0",""
"0","# A more sophisticated jitter plot is provided as below. We seperated the T2D subjects and normal "
"0","#subjects by their HbA1c levels."
"0",""
"0","m.prop.GSE50244 = rbind(melt(Est.prop.GSE50244$Est.prop.weighted), "
"0","                        melt(Est.prop.GSE50244$Est.prop.allgene))"
"0",""
"0","colnames(m.prop.GSE50244) = c('Sub', 'CellType', 'Prop')"
"0","m.prop.GSE50244$CellType = factor(m.prop.GSE50244$CellType, levels = c('alpha', 'beta', 'delta', 'gamma', 'acinar', 'ductal'))"
"0","m.prop.GSE50244$Method = factor(rep(c('MuSiC', 'NNLS'), each = 89*6), levels = c('MuSiC', 'NNLS'))"
"0","m.prop.GSE50244$HbA1c = rep(GSE50244.bulk.eset$hba1c, 2*6)"
"0","m.prop.GSE50244 = m.prop.GSE50244[!is.na(m.prop.GSE50244$HbA1c), ]"
"0","m.prop.GSE50244$Disease = factor(c('Normal', 'T2D')[(m.prop.GSE50244$HbA1c > 6.5)+1], levels = c('Normal', 'T2D'))"
"0","m.prop.GSE50244$D = (m.prop.GSE50244$Disease == 'T2D')/5"
"0","m.prop.GSE50244 = rbind(subset(m.prop.GSE50244, Disease == 'Normal'), subset(m.prop.GSE50244, Disease != 'Normal'))"
"0",""
"0","jitter.new = ggplot(m.prop.GSE50244, aes(Method, Prop)) + "
"0","  geom_point(aes(fill = Method, color = Disease, stroke = D, shape = Disease), "
"0","             size = 2, alpha = 0.7, position = position_jitter(width=0.25, height=0)) +"
"0","  facet_wrap(~ CellType, scales = 'free') + scale_colour_manual( values = c('white', ""gray20"")) +"
"0","  scale_shape_manual(values = c(21, 24))+ theme_minimal()"
"0",""
"0","plot_grid(jitter.fig, jitter.new, labels = 'auto')"
